<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Şifremi Unuttum</title>
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="../js/apiService.js"></script>
    <script src="../js/forgot-password.js"></script>
</head>
<body>
<div class="forgot-password-container auth-container">
    <h2>Şifremi Unuttum</h2>
    <p class="form-hint">Lütfen hesabınızı kurtarmak için kullanmak istediğiniz doğrulama yöntemini seçin ve ilgili bilgiyi girin.</p>

    <!-- Doğrulama yöntemi seçici -->
    <div class="login-method-selector">
        <button id="emailResetBtn" class="login-method-btn active" data-method="email">E-posta ile Sıfırla</button>
        <button id="phoneResetBtn" class="login-method-btn" data-method="phone">Telefon ile Sıfırla</button>
    </div>

    <!-- Adım 1: Doğrulama Kodu İsteme -->
    <div id="step-1-request-code">
        <form id="forgot-password-form">
            <div class="form-group">
                <label for="identifier" id="identifierLabel">E-posta Adresi:</label>
                <input type="text" id="identifier" name="identifier" required>
                <small id="identifierHint" style="display:none;">Başında 0 olmadan 10 haneli olarak girin (5XXXXXXXXX)</small>
            </div>
            <button type="submit" class="btn-primary" id="send-code-btn">Doğrulama Kodu Gönder</button>
        </form>
    </div>

    <!-- Adım 2: Doğrulama ve Şifre Sıfırlama -->
    <div id="step-2-verify-code" style="display: none;">
        <p class="code-sent-message"></p>
        <form id="reset-password-form">
            <div class="form-group">
                <label for="reset-code">Doğrulama Kodu:</label>
                <input type="text" id="reset-code" name="resetCode" required pattern="[0-9]{6}" maxlength="6">
            </div>
            <div class="form-group">
                <label for="new-password">Yeni Şifre:</label>
                <input type="password" id="new-password" name="newPassword" required minlength="6">
                <small>En az 6 karakter uzunluğunda olmalıdır</small>
            </div>
            <div class="form-group">
                <label for="confirm-password">Yeni Şifre (Tekrar):</label>
                <input type="password" id="confirm-password" name="confirmPassword" required minlength="6">
                <p class="password-mismatch-error" style="display: none; color: red;">Şifreler eşleşmiyor</p>
            </div>
            <button type="submit" class="btn-primary" id="reset-password-btn">Şifreyi Sıfırla</button>
            <button type="button" class="btn-secondary" id="back-to-step-1">Geri</button>
        </form>
    </div>

    <div class="form-feedback" id="forgot-password-feedback"></div>

    <div class="auth-links">
        <a href="#/login">Giriş sayfasına dön</a>
    </div>
</div>
</body>
</html>