<!-- Giriş Sayfası Bileşeni -->
<div class="login-container auth-container">
    <h2>Giriş Yap</h2>
    
    <!-- Giriş yöntemi seçici -->
    <div class="login-method-selector">
        <button id="emailLoginBtn" class="login-method-btn active">E-posta ile Giriş</button>
        <button id="phoneLoginBtn" class="login-method-btn">Telefon ile Giriş</button>
    </div>
    
    <!-- E-posta ile giriş formu -->
    <form id="emailLoginForm" class="auth-form">
        <div class="form-group">
            <label for="email">E-posta Adresi</label>
            <input type="email" id="email" name="email" required placeholder="E-posta adresinizi girin">
        </div>
        <div class="form-group">
            <label for="password">Şifre</label>
            <input type="password" id="password" name="password" required placeholder="Şifrenizi girin">
        </div>
        <div class="form-options">
            <a href="#/forgot-password" class="forgot-password-link">Şifremi Unuttum</a>
        </div>
        <div class="form-group">
            <button type="submit" class="btn-submit">Giriş Yap</button>
        </div>
        <div class="form-links">
            <span>Hesabınız yok mu? <a href="#/register">Kayıt Ol</a></span>
        </div>
    </form>
    
    <!-- Telefon ile giriş formu (başlangıçta gizli) -->
    <form id="phoneLoginForm" class="auth-form" style="display: none;">
        <div class="form-group">
            <label for="phoneNumber">Telefon Numarası</label>
            <input type="tel" id="phoneNumber" name="phoneNumber" required placeholder="5XX XXX XX XX" pattern="5[0-9]{2}[0-9]{3}[0-9]{2}[0-9]{2}">
            <small>Başında 0 olmadan 10 haneli olarak girin (5XXXXXXXXX)</small>
        </div>
        <div class="form-group">
            <label for="passwordPhone">Şifre</label>
            <input type="password" id="passwordPhone" name="passwordPhone" required placeholder="Şifrenizi girin">
        </div>
        <div class="form-group">
            <button type="submit" class="btn-submit">Giriş Yap</button>
        </div>
        <div class="form-links">
            <span>Hesabınız yok mu? <a href="#/register">Kayıt Ol</a></span>
        </div>
    </form>
    
    <div id="loginMessage" class="auth-message"></div>
</div>

<script>
    // Form değişimi için event listener'lar
    document.getElementById('emailLoginBtn').addEventListener('click', function () {
        document.getElementById('emailLoginForm').style.display = 'block';
        document.getElementById('phoneLoginForm').style.display = 'none';
        document.getElementById('emailLoginBtn').classList.add('active');
        document.getElementById('phoneLoginBtn').classList.remove('active');
    });

    document.getElementById('phoneLoginBtn').addEventListener('click', function () {
        document.getElementById('emailLoginForm').style.display = 'none';
        document.getElementById('phoneLoginForm').style.display = 'block';
        document.getElementById('phoneLoginBtn').classList.add('active');
        document.getElementById('emailLoginBtn').classList.remove('active');
    });

    // E-posta ile giriş işlemi
    document.getElementById('emailLoginForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const messageEl = document.getElementById('loginMessage');

        messageEl.textContent = 'Giriş yapılıyor...';
        messageEl.className = 'auth-message info';

        try {
            const data = await apiService.login(email, password);

            if (data && data.token) {
                // UI'ı güncelle
                if (typeof window.showLoggedInUI === 'function') {
                    window.showLoggedInUI();
                }

                messageEl.textContent = 'Giriş başarılı! Yönlendiriliyorsunuz...';
                messageEl.className = 'auth-message success';

                setTimeout(() => {
                    window.location.hash = '/';
                }, 1000);
            } else {
                throw new Error(data.message || 'Giriş başarısız');
            }
        } catch (error) {
            console.error('Giriş hatası:', error);
            messageEl.textContent = 'Giriş yapılamadı. Lütfen bilgilerinizi kontrol edin.';
            messageEl.className = 'auth-message error';
        }
    });

    // Telefon ile giriş işlemi
    document.getElementById('phoneLoginForm').addEventListener('submit', async function (e) {
        e.preventDefault();

        const phoneNumber = document.getElementById('phoneNumber').value;
        const password = document.getElementById('passwordPhone').value;
        const messageEl = document.getElementById('loginMessage');

        messageEl.textContent = 'Giriş yapılıyor...';
        messageEl.className = 'auth-message info';

        try {
            const data = await apiService.login(phoneNumber, password);

            if (data && data.token) {
                // UI'ı güncelle
                if (typeof window.showLoggedInUI === 'function') {
                    window.showLoggedInUI();
                }

                messageEl.textContent = 'Giriş başarılı! Yönlendiriliyorsunuz...';
                messageEl.className = 'auth-message success';

                setTimeout(() => {
                    window.location.hash = '/';
                }, 1000);
            } else {
                throw new Error(data.message || 'Giriş başarısız');
            }
        } catch (error) {
            console.error('Giriş hatası:', error);
            messageEl.textContent = 'Giriş yapılamadı. Lütfen bilgilerinizi kontrol edin.';
            messageEl.className = 'auth-message error';
        }
    });
</script>